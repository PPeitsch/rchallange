"0",""
"0","# Read ticker prices data"
"0","big_tech_stock_prices <- readRDS(here::here(""data"", ""big_tech_stock_prices_cleaned.RDS""))"
"0",""
"0","# Filter data only for the 5 selected companies"
"0","selected_tickers <- c(""AAPL"", ""AMZN"", ""META"", ""MSFT"", ""TSLA"")"
"0","correlation_data <- big_tech_stock_prices %>%"
"0","  filter(stock_symbol %in% selected_tickers) %>%"
"0","  select(stock_symbol, date, close) %>%"
"0","  group_by(date, stock_symbol) %>%"
"0","  drop_na()"
"0",""
"0","# Create a wide data frame"
"0","correlation_matrix <- correlation_data %>%"
"0","  pivot_wider(names_from = stock_symbol,"
"0","              values_from = close) %>%"
"0","  drop_na()"
"0",""
"0","correlation_matrix <- correlation_matrix[, -1]"
"0",""
"0","# Calculate the correlation matrix"
"0","correlation_m <- cor(correlation_matrix)"
"0",""
"0","# Create a correlation plot"
"0","# correlation_plot <- corrplot(correlation_m,"
"0","#                              method = ""circle"","
"0","#                              type = ""upper"","
"0","#                              tl.col = ""black"","
"0","#                              tl.srt = 45)"
"0",""
"0","# Create a table object with correlation statistics"
"0","correlation_stats <- data.frame("
"0","  Mean = apply(correlation_matrix, 2, mean, na.rm = TRUE),"
"0","  SD = apply(correlation_matrix, 2, sd, na.rm = TRUE),"
"0","  Min = apply(correlation_matrix, 2, min, na.rm = TRUE),"
"0","  Max = apply(correlation_matrix, 2, max, na.rm = TRUE)"
"0",")"
"0",""
"0","# Show the table in the document"
"0","# kable(correlation_stats, ""html"") %>%"
"0","#   kable_styling(full_width = FALSE, bootstrap_options = ""striped"", font_size = 10)"
"0",""
"0","# Get dates from the original matrix"
"0","dates <- correlation_data %>%"
"0","  select(date) %>%"
"0","  distinct()"
"0",""
"0","# Check if lengths are equal and adjust if necessary"
"0","if (nrow(correlation_matrix) != nrow(dates)) {"
"0","  warning(""Adjusting the length of dates to match the correlation matrix."")"
"0","  dates <- head(dates, nrow(correlation_matrix))"
"0","}"
"0",""
"0","# Add the date column to the correlation matrix"
"0","correlation_matrix <- bind_cols(dates, correlation_matrix)"
"0",""
